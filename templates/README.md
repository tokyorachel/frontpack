# Frontpack: A Modern Frontend-focused D8 Theme

* [Set up Local Development](#set-up-local-development)
  * [Acquia BLT + DrupalVM](#acquia-blt-drupalvm)
  * [Using shell script to install node](#using-shell-script-to-install-node)
  * [Running the build tools](#running-the-build-tools)
* [Theme Overview](#theme-overview)
  * [Folder Structure](#folder-structure)
  * [Sass Structure](#sass-structure)
  * [Webpack](#webpack)
  * [JavaScript](#javascript)
  * [Grid System](#grid-system)
  * [Theme Regions](#theme-regions)
  * [Images](#images)
  * [Utility Scripts](#utility-scripts)

---


## Set up local development

If you haven't already, enable your new sub theme. For a theme with the machine name `my_theme`:

`drush theme:enable my_theme`

`drush config-set system.theme default`

Once you have created a custom theme, you need to do a bit of environment set up in order to run the build tools.


### Acquia BLT + DrupalVM

[Acquia BLT](http://blt.readthedocs.io/en/latest/) is a project build system. If your project is using BLT + DrupalVM, do not use the provided shell script to install node (it won't work anyway). The BLT provided version of DrupalVM has node provisioned out of the box (currently should be node 8). If you need to adjust this version for your team, you can edit the `box/config.yml` variable `nodejs_version`, and then when the machine is provisioned or reprovisioned it will get the new version. For example, to set the version of node to 9+:

* Set `nodejs_version: "9.x"` in `box/config.yml`
* If box is already built, call `vagrant provision` to install the new node version

You may also want to add or remove global node packages in `nodejs_npm_global_packages`, depending on the needs of your project.


### Using shell script to install node
This shell script is provided to enable more consistent local environment set up when not using a VM or Docker based solution. It installs [nvm](https://github.com/creationix/nvm) and whatever version of node is provided to it as an argument. It is provided for utility only and there is no guarantee it will work on your local system. It will not work on Windows as nvm does not support Windows. [See 'important notes'](https://github.com/creationix/nvm#important-notes).

Steps: 
* Navigate to `themes/custom/my_theme` folder in your terminal
* Make install script executable `chmod +x install-node.sh `
* Install Node.js with `./install-node.sh 8.9.1` and then point to the proper version with `source ~/.bashrc && nvm use --delete-prefix 8.9.1` 
  * (optional) If you are not using avn then run `nvm use 8.9.1` when closing and reopening your session
  * (optional) If you choose to use avn follow the instructions [here](_readme/setup-full.md#avn)


### Running the build tools

* Run the command `npm install` within your `themes/custom/your-theme-name` folder
* To confirm Webpack and other items are instantiated `npm run build`
* You can now compile and watch both your scss and js file with `npm run watch`

NOTE: all npm commands need to be run from within the `/custom/your-theme-name` directory!


## Theme Overview


### Folder Structure

```
|-- build/  (generated css and js bundles) 
|-- config/  (webpack configuration files) 
|-- images/  (theme images)
|-- node_modules/  (modules generated by npm)
|-- src/  (raw js and scss files, these are the files you should modify)
|-- templates/  (folder for Drupal theme template files)
|-- .babelrc  (configuration for Babel transpiler)
|-- .eslintrc  (configuration for theme js eslint settings)
|-- .stylelintrc  (configuration for theme scss stylelint settings)
|-- install-node.sh (bash script to install nvm and node)
|-- package.json  (configured to load dependencies by npm)
|-- README.md (This file)
|-- [theme-name].info.yml (theme config file)
|-- [theme-name].libraries.yml (starter libraries file to load theme assets)
|-- [theme-name].theme (file to use for preprocess functions)
|-- theme-settings.php (file to use for making theme settings available in the GUI)
```


## Sass Structure

Setup of the Sass files so that they are properly broken out in partials.

```
scss/
  |-- global/
  |-- components/
  |-- style.scss
```

* **global/** intended as the baseline styling for HTML elements that you extend upon and will include things like resets, global typography, or common form selectors. This directory also contains mixins and variables files
* **components/** these module files are the reusable or component parts of our design.


## Webpack 

Webpack handles JS transpiling with [Babel](https://babeljs.io), Sass compiling, [Autoprefixing](https://github.com/postcss/autoprefixer) css with [PostCSS](https://github.com/postcss/postcss), [JS linting](https://eslint.org/), [SASS linting](https://stylelint.io/), uglification and optimization of production files, and for use in development watching front end files for updates when `npm run watch` is running.

Configuration files for webpack and postcss can be found in the config folder:

```
config/
  |-- postcss.config.js
  |-- webpack.common.js
  |-- webpack.dev.js
  |-- webpack.prod.js
```

Other relevant run command files are located in the theme root directory:

```
.babelrc
.eslintrc
.stylelintrc
```


## JavaScript

An example JS file `theme.js` is added by default in the `js/` folder. This file contains sample code wrapped in the `Drupal.behaviors` code standard. This JS file is added to the theme with the following portion of the code from `[theme-name].libraries.yml`.

```
lib:
  js:
    js/theme.js: {}
```


## Grid System

TBD


## Theme Regions

The regions available are standard with classic sidebar region, along with pre and post content areas. The intent is to allow for containers to go full-width and rely on the grid containers for inner Susy containers.

```
[theme-name].info.yml

regions:
  header: 'Header'
  primary_menu: 'Primary menu'
  secondary_menu: 'Secondary menu'
  page_top: 'Page top'
  page_bottom: 'Page bottom'
  featured: 'Featured'
  breadcrumb: 'Breadcrumb'
  content: 'Content'
  sidebar_first: 'Sidebar first'
  sidebar_second: 'Sidebar second'
  footer: 'Footer'

```


## Images 

The images designated for your custom theme can be placed in the `images/` folder.


## Utility Scripts


### Drush CEX Webform Tidy script

`cd docroot/themes/custom/your-theme`
Make the tidy script executable `chmod +x tidy-export.sh `
Now you can run this script whenever you need to export your configs, and it will do the drush export and then tidy the webform exports: `./tidy-export.sh`